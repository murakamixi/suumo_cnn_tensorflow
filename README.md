# suumo_cnn_tensorflow
tensorflowでsuumoの画像を分類するネットワークです。

# データセットの作成のために
**自作データセットを使うとき**
　データセットを作成するためには```python data_organize.py --file_num=ファイル数```でデータセットのための画像をそれぞれのラベルのディレクトリに分類することができます。
　データセットをラベルごとのディレクトリに分類することができたら、データセットを作成するために、```create_dataset.py ```を実行します。すると、```data/dataset.npz```が生成されます。
　自作クラスを使って訓練を行う時は最終的に以下のようなディレクトリ構成になっています。

```bash
data
 |--dataset.npz
```

これまだ
**ファインチューニングを行うとき**
　ファインチューニングを行う際は、```python data_organize.py --file_num=ファイル数 --finetuning=True```とします。すると、ラベルごとに分けられたディレクトリ```./data/train```,```./data/validation```が作成されます。
　ファインチューニングを行う時は最終的に以下のようなディレクトリ構成になっています。

```bash
data
 |--train
 |    |--label1
 |    .
 |    .
 |    .
 |    |--label6
 |
 |--validation
      |--label1
      .
      .
      .
      |--label6
```
　
## データの準備

　スクレイピングしてきた画像をsuumoディレクトリにまとめて、suumoディレクトリごとimgsに追加します。
　画像と同様にcsvディレクトリにcsvをまとめたsuumoディレクトリを追加します。

## 自作クラスで学習を行うためのデータセットの作成

　自作クラスで、学習を行う時は```python data_organize.py --file_num=ファイル数```行います。Colabの時はimgsとcsvを置いたディレクトリまでのパスを記載する必要があります。

### 実行(Local)

　```python data_organize.py --file_num=ファイル数```のようにファイル数を指定して実行すると、画像をimgs以下に作成されたディレクトリに振り分けられ、データセットを作成することができます。

### 実行(Colab)

　Colabで実行する場合は、colabで開き、ディレクトリ名を直接指定することで画像を分類することができます。imgsとcsvを置いたディレクトリまでのパスに```img_path```と```imgs_df```を変更する必要があります。

## ファインチューニングを行うとき
　ファインチューニングを行う際は、```python data_organize.py --file_num=ファイル数 --finetuning=True```とします。すると、ラベルごとに分けられたディレクトリ```./data/train```,```./data/validation```が作成されます。

### 実行(Local)

　```python data_organize.py --file_num=ファイル数```のようにファイル数を指定して実行すると、画像をimgs以下に作成されたディレクトリに振り分けられ、データセットを作成することができます。

### 実行(Colab)

　Colabで実行する場合は、colabで開き、ディレクトリ名を直接指定することで画像を分類することができます。imgsとcsvを置いたディレクトリまでのパスに```img_path```と```imgs_df```を変更する必要があります。

## データセットのnpzを作成
　自作データセットで学習を行う時は、データセットをまとめておいた方が、さまざまなネットワークを試すときに効率的です。そこでデータセットをまとめた```dataset.npz```を作成します。
　作成するためには、```create_dataset.py```を実行します。

　```--img_weight=64 --img_height=64```のように、画像サイズを引数で指定することもできます。

　colabで実行する際は、```create_dataset.ipynb```を使用することで作成することができます。